This is utility functions of version 3.